# Константы регулярных выражений

## Обзор

В проекте `go-tml-builder` мы вынесли часто используемые **сложные** паттерны регулярных выражений в константы для улучшения читаемости, поддерживаемости и консистентности кода.

**Принцип:** Выносим в константы только те паттерны, которые:
- Сложные и часто повторяются
- Могут меняться в будущем
- Улучшают читаемость кода

**Простые символы** (`^`, `$`, `"`, `//`, `,`, `;`, `=`, `?`, `%` и т.д.) используются напрямую в регулярных выражениях для лучшей читаемости.

## Файл констант

Все константы определены в файле `internal/providers/bsl/models/regex_patterns.go`.

## Категории констант

### 1. Границы слов (Word Boundaries)

```go
// Граница слова (включая кириллицу)
WordBoundary = `[^\wа-яё\.]`

// Граница слова в начале строки
WordBoundaryStart = `[^\wа-яё\.]|^`

// Граница слова в конце строки
WordBoundaryEnd = `[^\wа-яё\.]|$`

// Позитивный lookbehind для границы слова
WordBoundaryLookBehind = `(?<=[^\wа-яё\.]|^)`

// Позитивный lookahead для границы слова
WordBoundaryLookAhead = `(?=[^\wа-яё\.]|$)`
```

### 2. Идентификаторы (Identifiers)

```go
// Идентификатор (буква, цифра, подчеркивание, кириллица)
Identifier = `[_$[:alpha:]][_$[:alnum:]]*`

// Идентификатор с поддержкой кириллицы
IdentifierWithCyrillic = `[a-zа-яё0-9_]+`

// Идентификатор с кириллицей без учета регистра
IdentifierWithCyrillicCaseInsensitive = `(?i:[a-zа-яё0-9_]+)`
```

### 3. Литералы (Literals)

```go
// Числовой литерал
NumericLiteral = `(\d+\.?\d*)`

// Литерал даты
DateLiteral = `'((\d{4}[^\d']*\d{2}[^\d']*\d{2})([^\d']*\d{2}[^\d']*\d{2}([^\d']*\d{2})?)?)'`

// Экранированная кавычка
EscapedQuote = `""`
```

### 4. Специальные паттерны

```go
// Конец оператора (точка с запятой или ключевые слова)
StatementEnd = `(?i:(?=(;|Иначе|Конец)))`

// Граница слова без учета регистра
CaseInsensitiveWordBoundary = `(?i:(?<=[^\wа-яё\.]|^)(.*?)(?=[^\wа-яё\.]|$))`
```

## Шаблоны (Templates)

```go
// Шаблон для границы слова
WordBoundaryTemplate = `(?<=%s|^)(%s)(?=%s|$)`

// Шаблон для границы слова без учета регистра
CaseInsensitiveWordBoundaryTemplate = `(?i:(?<=%s|^)(%s)(?=%s|$))`
```

## Примеры использования

### До использования констант

```go
// Старый подход
Match: `(?i:(?<=[^\wа-яё\.]|^)(Если)(?=[^\wа-яё\.]|$))`
Begin: `(?i:(?<=;|^)\s*(Если))`
End: `(?i:(Тогда))`
```

### После использования констант

```go
// Новый подход - только для сложных паттернов
Match: fmt.Sprintf(`(?i:%s(%s)%s)`, 
    bslm.WordBoundaryLookBehind, 
    "Если", 
    bslm.WordBoundaryLookAhead)
Begin: `(?i:(?<=;|^)\s*(Если))`  // Простые символы напрямую
End: `(?i:(Тогда))`             // Простые символы напрямую
```

### Примеры в контексте

```go
// Граница слова для ключевого слова
keywordPattern := fmt.Sprintf(`(?i:%s(%s)%s)`, 
    bslm.WordBoundaryLookBehind, 
    "Если", 
    bslm.WordBoundaryLookAhead)

// Вызов функции (простые символы напрямую)
functionCallPattern := fmt.Sprintf(`(?<!(?i:Новый)\s+)(?:\s*(\.)\s*)?\\b(%s\\b)(?:\\s*)(\()\\s*`,
    bslm.Identifier)

// Числовой литерал с границами
numericPattern := fmt.Sprintf(`(?<=%s|^)%s(?=%s|$)`, 
    bslm.WordBoundary, bslm.NumericLiteral, bslm.WordBoundary)

// Строковый литерал (простые символы напрямую)
stringPattern := `(")(.*?)(")(?![")`

// Комментарий (простые символы напрямую)
commentPattern := `(^\s*//.*$)`
```

## Преимущества использования констант

1. **Читаемость**: сложные паттерны становятся понятными и самодокументируемыми
2. **Поддерживаемость**: изменения в сложных паттернах нужно делать только в одном месте
3. **Консистентность**: все правила используют одинаковые сложные паттерны
4. **Меньше ошибок**: исключена возможность опечаток в сложных регулярных выражениях
5. **Переиспользование**: константы можно использовать в разных частях кода
6. **Баланс**: простые символы остаются читаемыми, сложные - вынесены в константы

## Что НЕ выносится в константы

Простые символы и короткие паттерны, которые лучше читаются напрямую:

```go
// ✅ Хорошо - простые символы напрямую
Match: `(")`
Match: `(;)`
Match: `(\()`
Match: `(\))`
Match: `(,)`
Match: `(=)`
Match: `(\?)`
Match: `(%)`
Match: `(^\s*//.*$)`
Match: `\s*`

// ❌ Плохо - избыточные константы
Match: fmt.Sprintf(`(%s)`, bslm.StringQuote)
Match: fmt.Sprintf(`(%s)`, bslm.Semicolon)
Match: fmt.Sprintf(`(%s)`, bslm.ParenthesisStart)
```

## Запуск примера

Для демонстрации всех констант запустите:

```bash
go run examples/regex_patterns_demo.go
```

Этот пример покажет все доступные константы и их значения, а также примеры использования в контексте. 